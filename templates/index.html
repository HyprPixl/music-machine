<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Machine</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1>MUSIC<span class="highlight">MACHINE</span></h1>
            </div>
            <div class="transport-controls">
                <button id="play-btn" class="transport-btn">▶</button>
                <button id="stop-btn" class="transport-btn">■</button>
                <div class="bpm-control">
                    <label>BPM</label>
                    <input type="number" id="bpm-input" value="120" min="60" max="200">
                </div>
                <div class="timesig-control">
                    <label>Time Sig</label>
                    <div class="timesig-edit">
                        <select id="timesig-num">
                            <option>2</option>
                            <option>3</option>
                            <option selected>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                        </select>
                        <span>/</span>
                        <select id="timesig-den">
                            <option>2</option>
                            <option selected>4</option>
                            <option>8</option>
                            <option>16</option>
                        </select>
                    </div>
                </div>
                <div class="bars-control">
                    <label>Bars</label>
                    <div class="bars-edit">
                        <button id="bars-minus" class="mini-btn">−</button>
                        <span id="bars-count">1</span>
                        <button id="bars-plus" class="mini-btn">+</button>
                    </div>
                </div>
            </div>
            <div class="sequence-controls">
                <button id="new-sequence-btn" class="control-btn">NEW</button>
                <button id="save-sequence-btn" class="control-btn">SAVE</button>
                <button id="load-sequence-btn" class="control-btn">LOAD</button>
            </div>
        </header>

        <!-- Main Sequencer Grid -->
        <main class="sequencer-main">
            <!-- Step Indicators -->
            <div class="step-indicators">
                <div class="instrument-label"></div>
                <div class="steps-scroll" id="step-scroller">
                    <div class="steps-grid" id="step-indicators">
                        <!-- Step numbers will be generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Drum Section -->
            <section class="instrument-section" id="drums-section">
                <h2 class="section-title">DRUMS</h2>
                <div class="tracks-container" id="drum-tracks">
                    <!-- Drum tracks will be generated by JS -->
                </div>
            </section>

            <!-- Synth Section -->
            <section class="instrument-section" id="synths-section">
                <h2 class="section-title">SYNTHS</h2>
                <div class="tracks-container" id="synth-tracks">
                    <!-- Synth tracks will be generated by JS -->
                </div>
            </section>
        </main>

        <!-- Side Panel -->
        <aside class="side-panel">
            <div class="mixer-section">
                <h3>MIXER</h3>
                <div class="volume-controls">
                    <div class="volume-control">
                        <label>MASTER</label>
                        <input type="range" id="master-volume" min="0" max="1" step="0.01" value="0.7">
                        <span class="volume-value">70</span>
                    </div>
                    <div class="volume-control">
                        <label>DRUMS</label>
                        <input type="range" id="drums-volume" min="0" max="1" step="0.01" value="0.75">
                        <span class="volume-value">75</span>
                    </div>
                    <div class="volume-control">
                        <label>SYNTHS</label>
                        <input type="range" id="synths-volume" min="0" max="1" step="0.01" value="0.65">
                        <span class="volume-value">65</span>
                    </div>
                </div>
            </div>

            <div class="effects-section">
                <h3>EFFECTS</h3>
                <div class="effect-controls">
                    <div class="effect-control">
                        <label>REVERB</label>
                        <input type="range" id="reverb-level" min="0" max="1" step="0.01" value="0.2">
                        <span class="effect-value">20</span>
                    </div>
                    <div class="effect-control">
                        <label>DELAY</label>
                        <input type="range" id="delay-level" min="0" max="1" step="0.01" value="0.1">
                        <span class="effect-value">10</span>
                    </div>
                    <div class="effect-control">
                        <label>FILTER</label>
                        <input type="range" id="filter-level" min="0" max="1" step="0.01" value="0.0">
                        <span class="effect-value">0</span>
                    </div>
                </div>
            </div>

            <div class="pattern-section">
                <h3>PATTERNS</h3>
                <div class="pattern-controls">
                    <button class="pattern-btn active" data-pattern="1">1</button>
                    <button class="pattern-btn" data-pattern="2">2</button>
                    <button class="pattern-btn" data-pattern="3">3</button>
                    <button class="pattern-btn" data-pattern="4">4</button>
                </div>
            </div>

            <div class="help-section">
                <h3>HELP</h3>
                <div class="help-list">
                    <div class="help-group">
                        <div class="help-title">Navigation</div>
                        <ul>
                            <li><code>Arrow Left/Right</code>: Move selection</li>
                            <li><code>Enter</code>: Move down a row</li>
                            <li><code>Tab</code>: Jump to next beat</li>
                            <li><code>Space</code>: Move to next step</li>
                            <li><code>Backspace</code>: Clear current cell</li>
                        </ul>
                    </div>
                    <div class="help-group">
                        <div class="help-title">Synth Cells</div>
                        <ul>
                            <li><code>C–B</code>: Set note (auto-advance)</li>
                            <li><code>#</code>: Sharp (+1 semitone)</li>
                            <li><code>b</code>: Flat (−1 semitone)</li>
                            <li><code>Alt/Option + ↑/↓</code>: Octave ±12</li>
                            <li><code>↑/↓</code>: Semitone ±1</li>
                        </ul>
                    </div>
                    <div class="help-group">
                        <div class="help-title">Drum Cells</div>
                        <ul>
                            <li><code>X</code>: Activate current step (auto-advance)</li>
                            <li><code>Backspace</code>: Clear current step</li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Sequence Management Modal -->
        <div id="sequence-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Sequence Management</h2>
                <div class="modal-body">
                    <div class="input-group">
                        <label for="sequence-name">Name:</label>
                        <input type="text" id="sequence-name" placeholder="Untitled Sequence">
                    </div>
                    <div class="sequences-list" id="sequences-list">
                        <!-- Sequences will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-new-btn" class="modal-btn primary">Save New</button>
                    <button id="cancel-btn" class="modal-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/audio-engine.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sequencer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
